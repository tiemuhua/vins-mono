From c8017337ae690463d4910c198306270cfac6817e Mon Sep 17 00:00:00 2001
From: tiemuhuaguo <tiemuhuaguo@tencent.com>
Date: Sat, 24 Jun 2023 16:13:04 +0800
Subject: [PATCH] build

---
 .gitignore      |  3 ++-
 build.py        | 22 ++++++++++++++++++++++
 build_mac_m1.sh |  5 +++++
 3 files changed, 29 insertions(+), 1 deletion(-)
 create mode 100644 build.py
 create mode 100755 build_mac_m1.sh

diff --git a/.gitignore b/.gitignore
index f6ab76fda..996edf953 100644
--- a/.gitignore
+++ b/.gitignore
@@ -12,7 +12,6 @@ core
 core.*
 *.bak
 *~
-*build*
 *.moc.*
 *.moc
 ui_*
@@ -36,3 +35,5 @@ lapack/reference
 .settings
 Makefile
 !ci/build.gitlab-ci.yml
+/build*/
+/install*/
\ No newline at end of file
diff --git a/build.py b/build.py
new file mode 100644
index 000000000..d8129152b
--- /dev/null
+++ b/build.py
@@ -0,0 +1,22 @@
+import os
+import subprocess
+import platform
+
+PROJECT_PATH = os.path.split(os.path.realpath(__file__))[0] + '/'
+
+def call_shell(cmd:str)->int:
+    return subprocess.run(cmd.split(" "))
+
+if __name__ == '__main__':
+    BUILD_PATH:str = PROJECT_PATH + "build_" + platform.platform() + "/"
+    INSTALL_PATH:str = PROJECT_PATH + "install_" + platform.platform() + "/"
+    if not os.path.exists(BUILD_PATH):
+        os.makedirs(BUILD_PATH)
+    if not os.path.exists(INSTALL_PATH):
+        os.makedirs(INSTALL_PATH)
+    os.chdir(BUILD_PATH)
+    CMAKE_CMD:str = "cmake .. " + "-DCMAKE_INSTALL_PREFIX=" + INSTALL_PATH
+    call_shell(CMAKE_CMD)
+    call_shell("make -j$nproc")
+    call_shell("make install")
+    os.chdir("..")
diff --git a/build_mac_m1.sh b/build_mac_m1.sh
new file mode 100755
index 000000000..deabf08b8
--- /dev/null
+++ b/build_mac_m1.sh
@@ -0,0 +1,5 @@
+mkdir build_mac_m1_dir
+cd build_mac_m1_dir
+cmake .. -DCMAKE_INSTALL_PREFIX=/Users/gjt/3rd/eigen/install_mac_m1_dir
+make -j10
+make install
\ No newline at end of file
-- 
2.37.1 (Apple Git-137.1)

